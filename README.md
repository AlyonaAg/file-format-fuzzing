# file-format-fuzzing
 Программа, осуществляющая фаззинг формата файла.
 
 ## Функционал программы
1) Вывод конфигурационного файла в формате hex;
2) Однобайтовая замена.<br/>
Для выполнения замены одного байта нужно указать позицию сдвига от начала файла (в формате hex) и байт, на который будет произведена замена (в формате hex).
3) Замена нескольких байт.<br/>
Выполняется аналогично пункту 2, однако нужно указать ещё и количество заменяемых символов.
4) Дозапись в файл.<br/>
Для выполнения дозаписи в файл нужно указать байт, который будет дописан и количество.
5) Автоматическая замена байтов.<br/>
В данном режиме автоматически последовательно заменяются байты в файле. Количество заменяемых байтов зависит от выбранного режима: однобайтовая, двухбайтовая, трёхбайтовая или четырёхбайтовая.<br/>
Замена производится на граничные значения из следующего множества: {0x00, 0xFF, 0xFF / 2 - 1, 0xFF / 2 + 1, 0x0000, 0xFFFF, 0xFFFF / 2 - 1, 0xFFFF / 2 + 1, 0x000000, 0xFFFFFF, 0xFFFFFF / 2 - 1, 0xFFFFFF / 2 + 1, 0x00000000, 0xFFFFFFFF, 0xFFFFFFFF / 2 - 1, 0xFFFFFFFF / 2 + 1}.
6) Запуск программы.
7) Нахождение символов, разделяющих поля.<br/>
В данной функции среди всех символов заголовка ищутся определённые символы (=;:.). При нахождении выводится место расположения.
8) Нахождение границ полей в заголовке конфигурационного файла.<br/>
Данная функция сравнивает несколько конфигурационных файлов и на основе следующей эвристики выносит решения о том, где находятся границы полей: старшие байты поля будут неизменными для всех файлов, а младшие меняются.
9) Изменение поля размера строки.<br/>
Изменяются определённые байты в заголовке конфигурационного файла.
10) Изменение поля размер буфера.<br/>
Изменяются определённые байты в заголовке конфигурационного файла.


При возникновении исключения при работе программы логи собираются в файл. 

## Файлы для фаззинга
Исходный код:
- *Fuzz.cpp*
В папке *vuln* находятся:
- конфигурационный файл, фаззинг которого и производится;
- программа использующая для работы конфигурационный файл;
- библиотека для работы программы.

## IDAPython-скрипт
Скрипт *search.py* для обнаружения в дизассемблированном коде вызовов функций ввода данных и небезопасных функций
